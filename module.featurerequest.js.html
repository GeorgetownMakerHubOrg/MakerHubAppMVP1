<script>


$(function() {

  function showFeatureRequestScreen(){
    $(".appSection").hide();
    $(".featuresubmitresult").text("");
    $("#featureRequestTitle").val("");
    $("#featureRequestDescription").val("");
    $(".featureRequest").show();
    $("#featureRequestSubmit").off("click");
    
    $("#featureRequestSubmit").click(function(){
      console.log("submitting");
      $(".featuresubmitresult").text("Submitting...");
      var title = $("#featureRequestTitle").val();
      var description = $("#featureRequestDescription").val();
      
      google.script.run
      .withFailureHandler(function(e){
        console.log("ERROR in get netid ");
        console.log(e)
      })
      .withSuccessHandler(function(data){
        var netid = data;    
      
        google.script.run
        .withFailureHandler(function(error){console.log(error);})
        .withSuccessHandler(function(data){
          console.log("submitted");
          $(".featuresubmitresult").text("Thanks!");
          $("#featureRequestTitle").val("");
          $("#featureRequestDescription").val("");
          console.log(data);
        }).postTrelloFeatureRequest(title, description, netid);
      })
      .getCurrentSessionNetId();
    });  
  }


  $(".showFeatureRequest").click(function(){showFeatureRequestScreen(); return false;});
});
</script>


